/*! @source https://github.com/beautify-web/js-beautify/blob/master/js/lib/beautify-html.js */
!function(){function t(t){return t.replace(/^\s+/g,"")}function e(t){return t.replace(/\s+$/g,"")}function i(i,n,s,r){function m(){function i(t){var e="",i=function(i){var n=e+i.toLowerCase();e=n.length<=t.length?n:n.substr(n.length-t.length,t.length)},n=function(){return-1===e.indexOf(t)};return{add:i,doesNotMatch:n}}return this.pos=0,this.token="",this.current_mode="CONTENT",this.tags={parent:"parent1",parentcount:1,parent1:""},this.tag_type="",this.token_text=this.last_token=this.last_text=this.token_type="",this.newlines=0,this.indent_content=h,this.Utils={whitespace:"\n\r	 ".split(""),single_token:["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr","!doctype","?xml","?php","basefont","isindex"],extra_liners:b,in_array:function(t,e){for(var i=0;i<e.length;i++)if(t===e[i])return!0;return!1}},this.is_whitespace=function(t){for(var e=0;e<t.length;e++)if(!this.Utils.in_array(t.charAt(e),this.Utils.whitespace))return!1;return!0},this.traverse_whitespace=function(){var t="";if(t=this.input.charAt(this.pos),this.Utils.in_array(t,this.Utils.whitespace)){for(this.newlines=0;this.Utils.in_array(t,this.Utils.whitespace);)p&&"\n"===t&&this.newlines<=c&&(this.newlines+=1),this.pos++,t=this.input.charAt(this.pos);return!0}return!1},this.space_or_wrap=function(t){return this.line_char_count>=this.wrap_line_length?(this.print_newline(!1,t),this.print_indentation(t),!0):(this.line_char_count++,t.push(" "),!1)},this.get_content=function(){for(var t="",e=[];"<"!==this.input.charAt(this.pos);){if(this.pos>=this.input.length)return e.length?e.join(""):["","TK_EOF"];if(this.traverse_whitespace())this.space_or_wrap(e);else{if(g){var i=this.input.substr(this.pos,3);if("{{#"===i||"{{/"===i)break;if("{{!"===i)return[this.get_tag(),"TK_TAG_HANDLEBARS_COMMENT"];if("{{"===this.input.substr(this.pos,2)&&"{{else}}"===this.get_tag(!0))break}t=this.input.charAt(this.pos),this.pos++,this.line_char_count++,e.push(t)}}return e.length?e.join(""):""},this.get_contents_to=function(t){if(this.pos===this.input.length)return["","TK_EOF"];var e="",i=new RegExp("</"+t+"\\s*>","igm");i.lastIndex=this.pos;var n=i.exec(this.input),s=n?n.index:this.input.length;return this.pos<s&&(e=this.input.substring(this.pos,s),this.pos=s),e},this.record_tag=function(t){this.tags[t+"count"]?(this.tags[t+"count"]++,this.tags[t+this.tags[t+"count"]]=this.indent_level):(this.tags[t+"count"]=1,this.tags[t+this.tags[t+"count"]]=this.indent_level),this.tags[t+this.tags[t+"count"]+"parent"]=this.tags.parent,this.tags.parent=t+this.tags[t+"count"]},this.retrieve_tag=function(t){if(this.tags[t+"count"]){for(var e=this.tags.parent;e&&t+this.tags[t+"count"]!==e;)e=this.tags[e+"parent"];e&&(this.indent_level=this.tags[t+this.tags[t+"count"]],this.tags.parent=this.tags[e+"parent"]),delete this.tags[t+this.tags[t+"count"]+"parent"],delete this.tags[t+this.tags[t+"count"]],1===this.tags[t+"count"]?delete this.tags[t+"count"]:this.tags[t+"count"]--}},this.indent_to_tag=function(t){if(this.tags[t+"count"]){for(var e=this.tags.parent;e&&t+this.tags[t+"count"]!==e;)e=this.tags[e+"parent"];e&&(this.indent_level=this.tags[t+this.tags[t+"count"]])}},this.get_tag=function(t){var a,h,u,e="",i=[],n="",s=!1,r=!0,f=this.pos,o=this.line_char_count;t=void 0!==t?t:!1;do{if(this.pos>=this.input.length)return t&&(this.pos=f,this.line_char_count=o),i.length?i.join(""):["","TK_EOF"];if(e=this.input.charAt(this.pos),this.pos++,this.Utils.in_array(e,this.Utils.whitespace))s=!0;else{if(("'"===e||'"'===e)&&(e+=this.get_unformatted(e),s=!0),"="===e&&(s=!1),i.length&&"="!==i[i.length-1]&&">"!==e&&s){var p=this.space_or_wrap(i),c=p&&"/"!==e&&"force"!==d;if(s=!1,r||"force"!==d||"/"===e||(this.print_newline(!1,i),this.print_indentation(i),c=!0),c)for(var w=0;v>w;w++)i.push(l);for(var b=0;b<i.length;b++)if(" "===i[b]){r=!1;break}}if(g&&"<"===u&&e+this.input.charAt(this.pos)==="{{"&&(e+=this.get_unformatted("}}"),i.length&&" "!==i[i.length-1]&&"<"!==i[i.length-1]&&(e=" "+e),s=!0),"<"!==e||u||(a=this.pos-1,u="<"),g&&!u&&i.length>=2&&"{"===i[i.length-1]&&"{"===i[i.length-2]&&(a="#"===e||"/"===e||"!"===e?this.pos-3:this.pos-2,u="{"),this.line_char_count++,i.push(e),i[1]&&("!"===i[1]||"?"===i[1]||"%"===i[1])){i=[this.get_comment(a)];break}if(g&&i[1]&&"{"===i[1]&&i[2]&&"!"===i[2]){i=[this.get_comment(a)];break}if(g&&"{"===u&&i.length>2&&"}"===i[i.length-2]&&"}"===i[i.length-1])break}}while(">"!==e);var m,T,y=i.join("");m=-1!==y.indexOf(" ")?y.indexOf(" "):"{"===y.charAt(0)?y.indexOf("}"):y.indexOf(">"),T="<"!==y.charAt(0)&&g?"#"===y.charAt(2)?3:2:1;var k=y.substring(T,m).toLowerCase();return"/"===y.charAt(y.length-2)||this.Utils.in_array(k,this.Utils.single_token)?t||(this.tag_type="SINGLE"):g&&"{"===y.charAt(0)&&"else"===k?t||(this.indent_to_tag("if"),this.tag_type="HANDLEBARS_ELSE",this.indent_content=!0,this.traverse_whitespace()):this.is_unformatted(k,_)?(n=this.get_unformatted("</"+k+">",y),i.push(n),h=this.pos-1,this.tag_type="SINGLE"):"script"===k&&(-1===y.search("type")||y.search("type")>-1&&y.search(/\b(text|application)\/(x-)?(javascript|ecmascript|jscript|livescript|(ld\+)?json)/)>-1)?t||(this.record_tag(k),this.tag_type="SCRIPT"):"style"===k&&(-1===y.search("type")||y.search("type")>-1&&y.search("text/css")>-1)?t||(this.record_tag(k),this.tag_type="STYLE"):"!"===k.charAt(0)?t||(this.tag_type="SINGLE",this.traverse_whitespace()):t||("/"===k.charAt(0)?(this.retrieve_tag(k.substring(1)),this.tag_type="END"):(this.record_tag(k),"html"!==k.toLowerCase()&&(this.indent_content=!0),this.tag_type="START"),this.traverse_whitespace()&&this.space_or_wrap(i),this.Utils.in_array(k,this.Utils.extra_liners)&&(this.print_newline(!1,this.output),this.output.length&&"\n"!==this.output[this.output.length-2]&&this.print_newline(!0,this.output))),t&&(this.pos=f,this.line_char_count=o),i.join("")},this.get_comment=function(t){var e="",i=">",n=!1;this.pos=t;var s=this.input.charAt(this.pos);for(this.pos++;this.pos<=this.input.length&&(e+=s,e.charAt(e.length-1)!==i.charAt(i.length-1)||-1===e.indexOf(i));)!n&&e.length<10&&(0===e.indexOf("<![if")?(i="<![endif]>",n=!0):0===e.indexOf("<![cdata[")?(i="]]>",n=!0):0===e.indexOf("<![")?(i="]>",n=!0):0===e.indexOf("<!--")?(i="-->",n=!0):0===e.indexOf("{{!")?(i="}}",n=!0):0===e.indexOf("<?")?(i="?>",n=!0):0===e.indexOf("<%")&&(i="%>",n=!0)),s=this.input.charAt(this.pos),this.pos++;return e},this.get_unformatted=function(t,e){if(e&&-1!==e.toLowerCase().indexOf(t))return"";var n="",s="",r=!0,a=i(t);do{if(this.pos>=this.input.length)return s;if(n=this.input.charAt(this.pos),this.pos++,this.Utils.in_array(n,this.Utils.whitespace)){if(!r){this.line_char_count--;continue}if("\n"===n||"\r"===n){s+="\n",this.line_char_count=0;continue}}s+=n,a.add(n),this.line_char_count++,r=!0,g&&"{"===n&&s.length&&"{"===s.charAt(s.length-2)&&(s+=this.get_unformatted("}}"))}while(a.doesNotMatch());return s},this.get_token=function(){var t;if("TK_TAG_SCRIPT"===this.last_token||"TK_TAG_STYLE"===this.last_token){var e=this.last_token.substr(7);return t=this.get_contents_to(e),"string"!=typeof t?t:[t,"TK_"+e]}if("CONTENT"===this.current_mode)return t=this.get_content(),"string"!=typeof t?t:[t,"TK_CONTENT"];if("TAG"===this.current_mode){if(t=this.get_tag(),"string"!=typeof t)return t;var i="TK_TAG_"+this.tag_type;return[t,i]}},this.get_full_indent=function(t){return t=this.indent_level+t||0,1>t?"":Array(t+1).join(this.indent_string)},this.is_unformatted=function(t,e){if(!this.Utils.in_array(t,e))return!1;if("a"!==t.toLowerCase()||!this.Utils.in_array("a",e))return!0;var i=this.get_tag(!0),n=(i||"").match(/^\s*<\s*\/?([a-z]*)\s*[^>]*>\s*$/);return!n||this.Utils.in_array(n,e)?!0:!1},this.printer=function(i,n,s,r,a){this.input=i||"",this.input=this.input.replace(/\r\n|[\r\u2028\u2029]/g,"\n"),this.output=[],this.indent_character=n,this.indent_string="",this.indent_size=s,this.brace_style=a,this.indent_level=0,this.wrap_line_length=r,this.line_char_count=0;for(var h=0;h<this.indent_size;h++)this.indent_string+=this.indent_character;this.print_newline=function(t,i){this.line_char_count=0,i&&i.length&&(t||"\n"!==i[i.length-1])&&("\n"!==i[i.length-1]&&(i[i.length-1]=e(i[i.length-1])),i.push("\n"))},this.print_indentation=function(t){for(var e=0;e<this.indent_level;e++)t.push(this.indent_string),this.line_char_count+=this.indent_string.length},this.print_token=function(e){(!this.is_whitespace(e)||this.output.length)&&((e||""!==e)&&this.output.length&&"\n"===this.output[this.output.length-1]&&(this.print_indentation(this.output),e=t(e)),this.print_token_raw(e))},this.print_token_raw=function(t){this.newlines>0&&(t=e(t)),t&&""!==t&&(t.length>1&&"\n"===t.charAt(t.length-1)?(this.output.push(t.slice(0,-1)),this.print_newline(!1,this.output)):this.output.push(t));for(var i=0;i<this.newlines;i++)this.print_newline(i>0,this.output);this.newlines=0},this.indent=function(){this.indent_level++},this.unindent=function(){this.indent_level>0&&this.indent_level--}},this}var a,h,u,l,f,o,_,p,c,g,d,v,w,b,y;for(n=n||{},void 0!==n.wrap_line_length&&0!==parseInt(n.wrap_line_length,10)||void 0===n.max_char||0===parseInt(n.max_char,10)||(n.wrap_line_length=n.max_char),h=void 0===n.indent_inner_html?!1:n.indent_inner_html,u=void 0===n.indent_size?4:parseInt(n.indent_size,10),l=void 0===n.indent_char?" ":n.indent_char,o=void 0===n.brace_style?"collapse":n.brace_style,f=0===parseInt(n.wrap_line_length,10)?32786:parseInt(n.wrap_line_length||250,10),_=n.unformatted||["a","abbr","area","audio","b","bdi","bdo","br","button","canvas","cite","code","data","datalist","del","dfn","em","embed","i","iframe","img","input","ins","kbd","keygen","label","map","mark","math","meter","noscript","object","output","progress","q","ruby","s","samp","select","small","span","strong","sub","sup","svg","template","textarea","time","u","var","video","wbr","text","acronym","address","big","dt","ins","small","strike","tt","pre","h1","h2","h3","h4","h5","h6"],p=void 0===n.preserve_newlines?!0:n.preserve_newlines,c=p?isNaN(parseInt(n.max_preserve_newlines,10))?32786:parseInt(n.max_preserve_newlines,10):0,g=void 0===n.indent_handlebars?!1:n.indent_handlebars,d=void 0===n.wrap_attributes?"auto":n.wrap_attributes,v=isNaN(parseInt(n.wrap_attributes_indent_size,10))?u:parseInt(n.wrap_attributes_indent_size,10),w=void 0===n.end_with_newline?!1:n.end_with_newline,b="object"==typeof n.extra_liners&&n.extra_liners?n.extra_liners.concat():"string"==typeof n.extra_liners?n.extra_liners.split(","):"head,body,/html".split(","),y=n.eol?n.eol:"\n",n.indent_with_tabs&&(l="	",u=1),y=y.replace(/\\r/,"\r").replace(/\\n/,"\n"),a=new m,a.printer(i,l,u,f,o);;){var T=a.get_token();if(a.token_text=T[0],a.token_type=T[1],"TK_EOF"===a.token_type)break;switch(a.token_type){case"TK_TAG_START":a.print_newline(!1,a.output),a.print_token(a.token_text),a.indent_content&&(a.indent(),a.indent_content=!1),a.current_mode="CONTENT";break;case"TK_TAG_STYLE":case"TK_TAG_SCRIPT":a.print_newline(!1,a.output),a.print_token(a.token_text),a.current_mode="CONTENT";break;case"TK_TAG_END":if("TK_CONTENT"===a.last_token&&""===a.last_text){var k=a.token_text.match(/\w+/)[0],x=null;a.output.length&&(x=a.output[a.output.length-1].match(/(?:<|{{#)\s*(\w+)/)),(null===x||x[1]!==k&&!a.Utils.in_array(x[1],_))&&a.print_newline(!1,a.output)}a.print_token(a.token_text),a.current_mode="CONTENT";break;case"TK_TAG_SINGLE":var A=a.token_text.match(/^\s*<([a-z-]+)/i);A&&a.Utils.in_array(A[1],_)||a.print_newline(!1,a.output),a.print_token(a.token_text),a.current_mode="CONTENT";break;case"TK_TAG_HANDLEBARS_ELSE":for(var S=!1,E=a.output.length-1;E>=0&&"\n"!==a.output[E];E--)if(a.output[E].match(/{{#if/)){S=!0;break}S||a.print_newline(!1,a.output),a.print_token(a.token_text),a.indent_content&&(a.indent(),a.indent_content=!1),a.current_mode="CONTENT";break;case"TK_TAG_HANDLEBARS_COMMENT":a.print_token(a.token_text),a.current_mode="TAG";break;case"TK_CONTENT":a.print_token(a.token_text),a.current_mode="TAG";break;case"TK_STYLE":case"TK_SCRIPT":if(""!==a.token_text){a.print_newline(!1,a.output);var L,N=a.token_text,O=1;"TK_SCRIPT"===a.token_type?L="function"==typeof s&&s:"TK_STYLE"===a.token_type&&(L="function"==typeof r&&r),"keep"===n.indent_scripts?O=0:"separate"===n.indent_scripts&&(O=-a.indent_level);var C=a.get_full_indent(O);if(L){var U=function(){this.eol="\n"};U.prototype=n;var I=new U;N=L(N.replace(/^\s*/,C),I)}else{var K=N.match(/^\s*/)[0],G=K.match(/[^\n\r]*$/)[0].split(a.indent_string).length-1,j=a.get_full_indent(O-G);N=N.replace(/^\s*/,C).replace(/\r\n|\r|\n/g,"\n"+j).replace(/\s+$/,"")}N&&(a.print_token_raw(N),a.print_newline(!0,a.output))}a.current_mode="TAG";break;default:""!==a.token_text&&a.print_token(a.token_text)}a.last_token=a.token_type,a.last_text=a.token_text}var R=a.output.join("").replace(/[\r\n\t ]+$/,"");return w&&(R+="\n"),"\n"!==y&&(R=R.replace(/[\n]/g,y)),R}if("function"==typeof define&&define.amd)define(["require","./beautify","./beautify-css"],function(t){var e=t("./beautify"),n=t("./beautify-css");return{html_beautify:function(t,s){return i(t,s,e.js_beautify,n.css_beautify)}}});else if("undefined"!=typeof exports){var n=require("./beautify.js"),s=require("./beautify-css.js");exports.html_beautify=function(t,e){return i(t,e,n.js_beautify,s.css_beautify)}}else"undefined"!=typeof window?window.html_beautify=function(t,e){return i(t,e,window.js_beautify,window.css_beautify)}:"undefined"!=typeof global&&(global.html_beautify=function(t,e){return i(t,e,global.js_beautify,global.css_beautify)})}();
